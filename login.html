<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Meme Archive | Login</title>

    <link rel="icon" href="img/core-img/favicon.ico">
    <link rel="stylesheet" href="css/core-style.css">
    <link rel="stylesheet" href="style.css">

    <style>
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .main-content-wrapper {
            flex: 1;
        }
    </style>
</head>

<body>

<!-- ##### MAIN CONTENT ##### -->
<div class="main-content-wrapper d-flex align-items-center justify-content-center">

    <div class="cart-table-area section-padding-100">
        <div class="container">
            <div class="row justify-content-center">

                <div class="col-12 col-md-6">
                    <div class="checkout_details_area clearfix">

                        <h3 class="mb-30 text-center">Account Access</h3>

                        <!-- ALERT -->
                        <div id="alertBox"></div>

                        <!-- LOGIN FORM -->
                        <div id="loginForm">
                            <form id="formLogin">
                                <input type="email" class="form-control mb-3" id="loginEmail" placeholder="Email">
                                <input type="password" class="form-control mb-3" id="loginPassword" placeholder="Password">
                                <button type="submit" class="btn memeasoy-btn w-100">Login</button>
                            </form>
                            <p class="text-center mt-3">
                                Belum punya akun?
                                <a href="#" id="showRegister">Register</a>
                            </p>
                        </div>

                        <!-- REGISTER FORM -->
                        <div id="registerForm" style="display:none;">
                            <form id="formRegister">
                                <input type="text" class="form-control mb-3" id="regName" placeholder="Full Name">
                                <input type="email" class="form-control mb-3" id="regEmail" placeholder="Email">
                                <input type="password" class="form-control mb-3" id="regPassword" placeholder="Password">
                                <button type="submit" class="btn memeasoy-btn w-100">Register</button>
                            </form>
                            <p class="text-center mt-3">
                                Sudah punya akun?
                                <a href="#" id="showLogin">Login</a>
                            </p>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>

</div>

<!-- ##### FOOTER (STICKY BOTTOM) ##### -->
<footer class="footer_area clearfix" style="padding:15px 0;">
    <div class="container text-center">
        <p style="margin:0;font-size:13px;">
            Â© <script>document.write(new Date().getFullYear());</script> Meme Archive
        </p>
    </div>
</footer>

<!-- JS -->
<script src="js/jquery/jquery-2.2.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>

<script>
$(document).ready(function(){

    function showAlert(type, message){
        $("#alertBox").html(`
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                ${message}
                <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
        `);
    }

    // Toggle Register
    $("#showRegister").click(function(e){
        e.preventDefault();
        $("#loginForm").slideUp();
        $("#registerForm").slideDown();
        $("#alertBox").html("");
    });

    // Toggle Login
    $("#showLogin").click(function(e){
        e.preventDefault();
        $("#registerForm").slideUp();
        $("#loginForm").slideDown();
        $("#alertBox").html("");
    });

// LOGIN
$("#formLogin").submit(function(e){
    e.preventDefault();

    let email = $("#loginEmail").val();
    let pass  = $("#loginPassword").val();

    if(email === "" || pass === ""){
        showAlert("danger", "Email dan Password wajib diisi.");
        return;
    }

    $.ajax({
        url: "php/login.php",
        type: "POST",
        dataType: "json",
        data: {
            email: email,
            pass: pass
        },
        success: function(res){
            showAlert(
                res.status === "success" ? "success" : "danger",
                res.msg
            );

            if(res.status === "success"){
                setTimeout(function(){
                    window.location.href = "index.php";
                }, 1200);
            }
        },
        error: function(){
            showAlert("danger", "Server error.");
        }
    });
});


    // REGISTER
    $("#formRegister").submit(function(e){
    e.preventDefault();

    let nama  = $("#regName").val();
    let email = $("#regEmail").val();
    let pass  = $("#regPassword").val();

    if(nama === "" || email === "" || pass === ""){
        showAlert("danger", "Nama, email, dan password wajib diisi.");
        return;
    }

    $.ajax({
        url: "php/register.php",
        type: "POST",
        dataType: "json",
        data: {
            nama: nama,
            email: email,
            pass: pass
        },
        success: function(res){
            showAlert(
                res.status === "success" ? "success" : "danger",
                res.msg
            );

            if(res.status === "success"){
                setTimeout(function(){
                    $("#registerForm").slideUp();
                    $("#loginForm").slideDown();
                    $("#formRegister")[0].reset();
                }, 1200);
            }
        },
        error: function(){
            showAlert("danger", "Server error.");
        }
    });
});

});


</script>

</body>
</html>
